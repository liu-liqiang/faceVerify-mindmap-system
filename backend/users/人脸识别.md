# 思维导图管理系统

一个基于Django的思维导图管理系统，具有人脸识别登录和权限管理功能。

## 功能特点

### 1. 用户认证系统

- **注册功能**: 用户可以注册账号，需要提供用户名、姓名、警号、手机号码、所属单位和密码
- **人脸识别登录**:
  - 注册时需要录入人脸信息（至少3张不同角度的照片）
  - 登录时需要同时验证用户名密码和人脸识别
  - 采用模拟人脸识别技术（生产环境可替换为真实的face_recognition库）
- **审核机制**: 注册后需要管理员审核才能正常使用系统

### 2. 权限管理系统

- **用户权限分类**:
  - 创建者权限：可以编辑文件、管理权限
  - 编辑权限：可以查看和编辑文件内容
  - 只读权限：只能查看文件内容
  - 无权限：无法查看文件，会提示权限不足

- **权限授权**:
  - 只有文件创建者可以为其他用户授权
  - 可以授权给系统中的任何用户
  - 支持权限的添加、修改和删除

### 3. 文件管理功能

- **文件创建**: 创建新的思维导图文件
- **文件编辑**: 支持JSON格式的内容编辑
- **文件查看**: 查看文件详情和内容
- **权限管理**: 管理文件的访问权限
- **公开/私有**: 支持设置文件为公开或私有

## 技术栈

- **后端**: Django 5.2.3
- **数据库**: SQLite (开发环境)
- **前端**: Bootstrap 5.1.3 + Font Awesome 6.0.0
- **人脸识别**: PIL + 模拟算法 (可升级为OpenCV + face_recognition)

## 安装和运行

### 1. 环境要求

- Python 3.8+
- Django 5.2.3
- 其他依赖见 requirements.txt

### 2. 安装步骤

```bash
# 克隆项目
git clone <repository-url>
cd mymindmapproject

# 创建虚拟环境
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# 或
.venv\Scripts\activate  # Windows

# 安装依赖
pip install -r requirements.txt

# 数据库迁移
python manage.py makemigrations
python manage.py migrate

# 创建超级用户
python manage.py createsuperuser

# 启动服务器
python manage.py runserver
```

### 3. 访问系统

- 打开浏览器访问: <http://127.0.0.1:8000>
- 首次访问会跳转到登录页面
- 可以点击"立即注册"创建新账号

## 使用说明

### 1. 注册和登录

1. 点击"立即注册"创建账号
2. 填写用户信息后进入人脸注册页面
3. 允许摄像头权限，拍摄至少3张不同角度的人脸照片
4. 完成注册后使用用户名、密码和人脸识别登录

### 2. 文件管理

1. 登录后进入仪表板
2. 点击"创建新文件"创建思维导图
3. 在文件详情页可以查看和编辑内容
4. 使用权限管理功能为其他用户授权

### 3. 权限管理

1. 只有文件创建者可以管理权限
2. 在文件详情页点击"权限管理"
3. 选择用户和权限类型进行授权
4. 支持只读和编辑两种权限级别

## 系统架构

```
mymindmapproject/
├── user_management/          # 用户管理应用
│   ├── models.py            # 用户模型
│   ├── views.py             # 用户视图
│   ├── forms.py             # 用户表单
│   └── face_recognition_service.py  # 人脸识别服务
├── file_management/          # 文件管理应用
│   ├── models.py            # 文件模型
│   ├── views.py             # 文件视图
│   └── urls.py              # 文件路由
├── templates/               # 模板文件
├── static/                  # 静态文件
│   ├── css/                # 样式文件
│   └── js/                 # JavaScript文件
└── manage.py               # Django管理脚本
```

## 安全考虑

1. **人脸识别**: 当前使用模拟算法，生产环境建议使用真实的人脸识别库
2. **权限控制**: 严格的权限验证，确保用户只能访问授权的文件
3. **CSRF保护**: 所有表单都包含CSRF令牌
4. **输入验证**: 对所有用户输入进行验证和清理

## 扩展功能

未来可以添加的功能：

- 真实的人脸识别算法集成
- 实时协作编辑
- 文件版本控制
- 导出功能（PNG、PDF等）
- 移动端适配
- 文件搜索和标签
- 使用统计和分析

## 许可证

本项目基于MIT许可证开源。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。
